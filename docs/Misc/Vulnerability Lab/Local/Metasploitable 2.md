基于 Ubuntu 的系统靶场。

## 1 安装

扫描虚拟机

![扫描虚拟机](./../../../../images/Metasploitable%202/%E6%89%AB%E6%8F%8F%E8%99%9A%E6%8B%9F%E6%9C%BA.png)

升级此虚拟机

![升级此虚拟机](./../../../../images/Metasploitable%202/%E5%8D%87%E7%BA%A7%E6%AD%A4%E8%99%9A%E6%8B%9F%E6%9C%BA.png)

创建此虚拟机的新克隆

![创建此虚拟机的新克隆](./../../../../images/Metasploitable%202/%E5%88%9B%E5%BB%BA%E6%AD%A4%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%9A%84%E6%96%B0%E5%85%8B%E9%9A%86.png)

虚拟机名称

> metasploitable2

位置

> D:\documents\virtual machines\metasploitable2\metasploitable2-vm

**编辑虚拟机设置**

此虚拟机的内存

> 1 GB

处理器数量

> 1

每个处理器的内核数量

> 4

虚拟化引擎

> 虚拟化 Intel VT-X/EPT 或 AMD-V/RVI(V)

网络连接

> 桥接模式
>
> NAT

显示器

> 关闭加速 3D 图形

快照

> 拍摄新快照
>
> 确定

拍摄快照，命名为 `安装` 

## 2 初始化

**修改密码**

用户名

> msfadmin

密码

> msfadmin

修改 msfadmin 密码

```shell
msfadmin@metasploitable:~$ sudo passwd msfadmin
```

修改 root 密码

```shell
msfadmin@metasploitable:~$ sudo passwd root
```

重启，使用 root 登录

**配置网络**

配置网络接口参数

```shell
root@metasploitable:~# vim /etc/network/interfaces
```

```
 7  auto lo
 8  iface lo inet loopback
 
#iface eth0 inet dhcp
auto eth0
iface eth0 inet static
	address 192.168.1.19
	netmask 255.255.255.0
	broadcast 192.168.1.255
	gateway 192.168.1.1

#iface eth1 inet dhcp
auto eth1
iface eth1 inet static
	address 192.168.24.19
	netmask 255.255.255.0
	broadcast 192.168.24.255
```

修改 `dns` 服务器

```shell
root@metasploitable:~# vim /etc/resolv.conf
```

```
# Generated by NetworkManager
nameserver 8.8.8.8
nameserver 8.8.4.4
```

在 `hosts` 文件添加域名映射

```shell
root@metasploitable:~# vim /etc/hosts
```

```
192.168.1.13	kali-23.local
192.168.1.14	cent7-6.local
192.168.1.15	win10-22h2.local
192.168.1.16	win10-1903.local
192.168.1.17	win7-sp1.local
192.168.1.18	winxp-sp3.local
192.168.1.19	metasploitable2.local
192.168.24.20	svr08r2-sp1.local
192.168.1.22	rocky-9.local
```

重启网络服务并测试网络

```shell
┌──(root㉿kali)-[~]
└─# /etc/init.d/networking restart && ping g.cn -c 3
```

关机，快照命名为 初始化 

## 3 使用

### 3.1 检测 mysql 空密码

运行 msf

```shell
┌──(root㉿kali)-[~]
└─# msfdb run
```

查找 mysql 登录相关的模块

```shell
msf6 > search mysql login
```

使用 auxiliary/scanner/mysql/mysql_login

```shell
msf6 > use 0
```

显示 options

```shell
msf6 auxiliary(scanner/mysql/mysql_login) > show options
```

```shell
   BLANK_PASSWORDS   true             no        Try blank passwords for all users
```

> 可以看到这个 exploit 可以检测 mysql 的空密码

设置 rhosts

```shell
msf6 auxiliary(scanner/mysql/mysql_login) > set rhosts 192.168.1.56
```

运行

```shell
msf6 auxiliary(scanner/mysql/mysql_login) > run
```

```shell
[+] 192.168.1.56:3306     - 192.168.1.56:3306 - Found remote MySQL version 5.0.51a
[+] 192.168.1.56:3306     - 192.168.1.56:3306 - Success: 'root:'
[*] 192.168.1.56:3306     - Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed
```

> 检测到 root 密码为空
>
> 需要黑客与目标的 mysql 版本兼容

---

Refrences

- [Metasploitable 2](https://docs.rapid7.com/metasploit/metasploitable-2/)