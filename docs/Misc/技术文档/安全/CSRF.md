伪造敏感操作, 诱导目标执行.

## 1 PoC 生成

攻击者在 Burp Suite 拦截自己账户的敏感操作数据包，生成 PoC

![攻击者在 Burp Suite 拦截自己账户的敏感操作数据包，生成 PoC](./../../../../images/CSRF/%E6%94%BB%E5%87%BB%E8%80%85%E5%9C%A8%20Burp%20Suite%20%E6%8B%A6%E6%88%AA%E8%87%AA%E5%B7%B1%E8%B4%A6%E6%88%B7%E7%9A%84%E6%95%8F%E6%84%9F%E6%93%8D%E4%BD%9C%E6%95%B0%E6%8D%AE%E5%8C%85%EF%BC%8C%E7%94%9F%E6%88%90%20PoC.png)

保存到 HTML 文件

![保存到 HTML 文件](./../../../../images/CSRF/%E4%BF%9D%E5%AD%98%E5%88%B0%20HTML%20%E6%96%87%E4%BB%B6.png)

当目标在登录状态下点击这个 HTML 文件，就会执行敏感操作

## ==未归纳==

### csrf_ token 绕过

1. CSRF 令牌的验证取决于请求方法

   ```
   在这种情况下，攻击者可以切换到GET方法来绕过验证并进行CSRF攻击
   ```

2. CSRF 令牌的验证取决于令牌的存在

   ```
   在这种情况下，攻击者可以删除包含令牌的整个参数（而不仅仅是其值）以绕过验证并发起 CSRF 攻击
   ```

3. CSRF 令牌不与用户会话绑定

   ```
   在这种情况下，攻击者可以使用自己的帐户登录应用程序，获取有效令牌，然后在 CSRF 攻击中将该令牌提供给受害者用户
   ```

4. ==CSRF 令牌与非会话 cookie 绑定==

   ```
   攻击者可以使用自己的帐户登录应用程序，获取有效令牌和关联的 cookie，利用 cookie 设置行为将其 cookie 放入受害者的浏览器中，并在 CSRF 攻击中将其令牌提供给受害者。
   ```

5. csrf_ token 长期不更新，可重复使用

