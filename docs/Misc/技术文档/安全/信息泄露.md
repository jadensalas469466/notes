敏感数据可被任意访问。

## 1 AccessKey 泄露

AccessKey ID 和 AccessKey Secret 是调用云服务器 API 时用于完成身份验证的凭证，AccessKey 泄露会对该账号下所有资源的安全带来威胁。

HUNTER

```
domain.suffix="example.com" && (web.body="AccessKey ID" || web.body="AccessKey Secret")
```

FOFA

```
domain="example.com" && (body="AccessKey ID" || body="AccessKey Secret")
```

Google

```
site:"example.com" "AccessKey ID" OR "AccessKey Secret"
```

Search Public Code

```
"example.com" AND ("AccessKey ID" OR "AccessKey Secret")
```

---

参考链接

- [云业务 AccessKey 标识特征整理](https://wiki.teamssix.com/cloudservice/more/)
- [云上攻防 | 记一次AccessKey值泄露的挖掘和分析](https://rivers.chaitin.cn/blog/cqq5arp0lnec5jjugkqg)

## ==未归纳==

## 1 敏感信息

可以写个字典（跑包时 GET 和 POST 都可以尝试一下）

```
GIT:https://github.com/lijiejie/GitHack
SVN:https://github.com/callmefeifei/svnHack
Ds_store:https://github.com/lijiejie/ds_store_exp
Spring:xxx/swagger-resources
Bash
History
Ds
Htacess
druid
```

spring

```
访问 https://[host]/swagger-resources
得到：
[{"name":"default","location":"--/internal--/svgr","swaggerVersion":"2.0"}]
可尝试拼接 https://xxx.com/--/internal--/swgr
```

## 2 地图 API 泄露

````
百度地图
```特征
ak=SA1vncDqp8vNAVIn1WUGIQkE7G5cDdbP
```
```利用
https://api.map.baidu.com/place/v2/search?query=ATM%E6%9C%BA&tag=%E9%93%B6%E8%A1%8C&region=%E5%8C%97%E4%BA%AC&output=json&ak=SA1vncDqp8vNAVIn1WUGIQkE7G5cDdbP
```
````

## 4 Web 目录

有账号密码或开发文档，漏洞报告可直接提交

## 5 文件泄露

不需要利用可直接提交

1. git 源码泄露

   ```
   位置：https://example.com/.git
   利用：https://github.com/lijiejie/GitHack
   ```

2. svn 信息泄露

   ```
   位置：https://example.com/.svn/entries
   利用：https://github.com/callmefeifei/svnHack,https://github.com/admintony/svnExploit
   ```

3. DS_Store 文件泄露

   ```
   位置：https://example.com/.DS_Store
   利用：https://github.com/lijiejie/ds_store_exp
   ```

4. .htaccess 或 .htpasswd 文件泄露

   ```
   位置：https://example.com/.htaccess,https://example.com/.htpasswd
   ```

5. 其它

   ```
   /debug/pprof/cmdline
   /graphql
   /tenant
   /sources
   /.bashrc
   /.ssh/authorized_keys
   /.bash_history
   ```

## 6 未授权访问漏洞

1. druid 未授权访问

   ```
   位置：
   https://example.com/druid/index.html
   https://example.com/druid/sql.html
   https://example.com/druid/weburi.html
   https://example.com/druid/websession.html
   https://example.com/druid/weburi.json
   https://example.com/druid/websession.json
   https://example.com/druid/login.html
   ```

2. spring 的 env 泄漏

   ```
   位置：https://example.com/actuator/env
   可尝试复现利用
   ```

3. spring 的 swagger 泄露

   ```
   位置：https://example.com/swagger-ui.html
   可直接提交，建议测试里面的接口
   ```

4. sql 查询语句泄露

   ```
   使之报错，爆出 sql 查询语句
   ```

## 7 网盘泄露

1. 建议凌风云

   ```
   使用 企业名 + 关键词排查
   合同，设计图纸，身份证，通讯录，花名册，报表，投标文件，入职等
   情报提交时说明网盘链接和截图，方便厂商排查即可。
   
   https://www.lingfengyun.com/
   https://www.quzhuanpan.com/
   https://www.pansoso.com/
   http://wp.soshoulu.com/
   ```

## 8 搜索引擎

1. google

   ```
   filetype:xls site:xxx.example.com sfzh
   filetype:xls site:xxx.example.com 身份证号
   filetype:pdf site:xxx.example.com sfzh
   filetype:pdf site:xxx.example.com 身份证号
   ```

2. bing

   ```
   inurl:example
   inurl：PDF 机密等级 ABC
   inurl:/backup
   intitle:index of backup
   intext:*sql
   site:xxx.example.com
   ```

   ### 易忽略的漏洞

   1. 爆破出密码但是需要二次验证的，可直接提交

   2. js 文件中代码显示会跳转到非法网站，疑似被黑 

   3. 点赞直接将网站的点赞量修改，如 11 修改为 22

   4. 日志文件，*.log 如 access.log

   5. 文件上传 xss （pdf，html，svg）

   6. xxl-job 命令执行

      ```
      登入后台管理，插入计划任务反弹 shell
      ```

   7. shiro

      ```
      特征：rememberMe=
      ```

   8. app 中的 xss
