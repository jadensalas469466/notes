# 支付逻辑漏洞

## int

当涉及到支付时，如支付宝，微信使用的是  int 计数（-2,147,483,648 到 2,147,483,647）

```
第三方支付时使用 int 范围一般是 0-217483648
则 217483649 = 1
217483650 = 2
```

> 若某个产品单价为 ￥2，那么购买 1073741825 个产品的价格为 1073741825 x 2 = 217483650 = 2

## 科学计数法

计算机表达 10 的 13 次冥是 1e + 13 = 10000000000000 = 1 × 10^13

 10 的 -13 次冥是 1e - 13 = 10000000000000 = 1 × 10^-13

可理解为 1e + 13 等于 1 后面加 13 个 0，1e - 13 等于小数点向左移动 13 位

1e + 1 = 10

1e + 2 = 100

1e - 1 = 0.1

1e - 2 = 0.01

```
当遇到某些支付时无法输入小数，可通过科学计数法输入 1e - 1 = 0.1 来绕过
```

## 四舍五入

充值 0.016 = 到账 0.02

```
在某些情况下充值 0.016 前端由于显示限制会显示 0.01
那么可以再充值一次 0.016 ，若显示为 0.02 则没有漏洞，若显示 0.03 则有漏洞
若反馈危害较小可通过脚本并发，扩大危害
```

## 参数

**Pirce**

```
Pirce 常用于表示金额，可尝试改为 -1,0.01,0.019,217483649
```

**num**

```
num 常用于表示数目
```

**id**

```
product id 商品 id (可用于直接购买赠品，隐藏优惠券)
user id    用户 id（水平越权）
address id 地址 id（下单到其他人的地址 id 可能会显示其他人的地址，属于敏感信息泄露）
```

